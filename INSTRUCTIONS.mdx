# Relation One To One

### ğŸ’¡ Comprendre les relations 1-1

## ğŸ“ Tes notes

Detaille ce que tu as appris ici,Â surÂ uneÂ pageÂ [Notion](https://go.mikecodeur.com/course-notes-template)

## Comprendre

Rappel

Voici un bref rappel des types de relations en bases de donnÃ©es relationnelles :

### 1. Relation **1-1** (One-to-One)

- **Description** : Chaque enregistrement dans une table A correspond Ã  un seul enregistrement dans une table B, et vice versa.
- **Exemple** : Un utilisateur (`users`) et son profil dÃ©taillÃ© (`user_profiles`). Chaque utilisateur a un profil unique.
- **ImplÃ©mentation** : Utilisation d'une clÃ© Ã©trangÃ¨re (foreign key) avec une contrainte d'unicitÃ© (`UNIQUE`) dans l'une des tables.

### 2. Relation **1-N** (One-to-Many)

- **Description** : Un enregistrement dans la table A peut Ãªtre associÃ© Ã  plusieurs enregistrements dans la table B, mais chaque enregistrement dans la table B est liÃ© Ã  un seul enregistrement dans la table A.
- **Exemple** : Un auteur (`authors`) et ses livres (`books`). Un auteur peut avoir plusieurs livres, mais chaque livre a un seul auteur.
- **ImplÃ©mentation** : La table B contient une clÃ© Ã©trangÃ¨re qui pointe vers la clÃ© primaire de la table A.

### 3. Relation **N-N** (Many-to-Many)

- **Description** : Un enregistrement dans la table A peut Ãªtre associÃ© Ã  plusieurs enregistrements dans la table B, et vice versa.
- **Exemple** : Les Ã©tudiants (`students`) et les cours (`courses`). Un Ã©tudiant peut suivre plusieurs cours, et un cours peut Ãªtre suivi par plusieurs Ã©tudiants.
- **ImplÃ©mentation** : CrÃ©ation d'une table de jonction (ou d'association) avec deux clÃ©s Ã©trangÃ¨res, une pointant vers la table A et l'autre vers la table B.

Pour crÃ©er des relation en SQL il faut plusieurs tables contenant chacune une `PK (Primary Key)`. La liaison se fait via un clef Ã©trangÃ¨re, `FK (Foreign Key)`. On utilise `REFERENCES` pour dÃ©finir la FK. Exemple :

```sql
CREATE TABLE users (
    id serial PRIMARY KEY,
    name text NOT NULL
);

CREATE TABLE orders (
    id serial PRIMARY KEY,
    user_id integer NOT NULL,
    order_date date NOT NULL,
    FOREIGN KEY (user_id) REFERENCES users(id)
);
```

### Drizzle : relation / rÃ©fÃ©rences

Pour dÃ©finir des relations avec `Drizzle` nous avons besoin de 2 choses :

- DÃ©finir les FK (avec `references`), cela applique les contraintes sur la BDD
  - Doc : https://orm.drizzle.team/docs/rqb#foreign-keys
- DÃ©finir les Relation (Au niveau applicatif avec `relation`)
  - Doc : https://orm.drizzle.team/docs/rqb#one-to-one

Exemple de dÃ©finition de relation 1-1

```tsx
import { pgTable, serial, text, integer, boolean } from 'drizzle-orm/pg-core';
import { relations } from 'drizzle-orm';

//table 1
export const users = pgTable('users', {
  id: serial('id').primaryKey(),
  name: text('name'),
});
//table 2
export const profileInfo = pgTable('profile_info', {
  id: serial('id').primaryKey(),
  userId: integer("user_id").references(() => users.id), // FK
  metadata: jsonb("metadata"),
});
//RELATION
export const usersRelations = relations(users, ({ one, many }) => ({
  profileInfo: one(users, {
    fields: [profileInfo.userId],
    references: [users.id],
  }),
}));

```

ğŸ“‘ Le liens vers la doc [https://fr.reactjs.org/docs/getting-started.html](https://fr.reactjs.org/docs/getting-started.html)

Des frameworks JavaScript modernes ont donc Ã©tÃ© crÃ©Ã©s pour relever certains des dÃ©fis en crÃ©ant par programme le DOM plutÃ´t que de le dÃ©finir Ã  la main HTML.

## Exercice

**ğŸ¶D**ans cet exercice tu vas devoir crÃ©er une relation 1-1 entre `USER` et `PROFILEINFO`

Fichiers

- `src/db/schema/user.ts`

## Bonus

### 1. ğŸš€ Query

La puissance de lâ€™ORM rÃ©side Ã©galement dans le fait que lorsque lâ€™on dÃ©finis correctement les relations, il est trÃ¨s simple dâ€™accÃ©der aux donnÃ©es ainsi que les donnÃ©es associÃ© au lieu dâ€™avoir a faire plusieurs requÃªtes SQL sÃ©parÃ©s ou une grosse requÃªtes complexe avec des jointures.

**ğŸ¶** Dans cet exercice tu vas appeler `USER` et demander dâ€™avoir le profil avec pour afficher la note

ğŸ“‘ Le lien vers la doc [https://orm.drizzle.team/docs/rqb](https://orm.drizzle.team/docs/rqb)

Fichiers

- `exercise/relation-one/page`

## Aller plus loin

ğŸ“‘ Le lien vers la doc [https://orm.drizzle.team/docs/rqb](https://orm.drizzle.team/docs/rqb)

## Ils vont tâ€™aider

- **ğŸ¶ Mowgli le Chien** : _Mowgli te guidera dans chaque exercice._
- **ğŸ¤– Ash le Robot** : _Ash le Robot te donnera du code utile._
- **ğŸš€ Julia La roquette** : _Julia te donnera des dÃ©fis supplÃ©mentaires._
- **â›ï¸ Hulk le Marteau** : _Quand du code Ã  supprimer est prÃ©sent_
- **ğŸ‘¨â€âœˆï¸ Hugo le chef de projet** : _Va t'aider sur les spÃ©cifications du projet_

## ğŸœ Feedback

Remplir le formulaire le [formulaire de FeedBack](https://go.mikecodeur.com/cours-next-avis?entry.1912869708=Next%20PRO&entry.1430994900=Data%20Modeling&entry.533578441=06%20Relation%201-1).
